webpackJsonp([7],{403:function(e,t,r){"use strict";var a=r(75),s=r.n(a),o=r(76),i=r.n(o),n=r(3);t.a={getStoreData:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.post("/api/order/v1/order/findAvailableStore");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},t,e)}))()},getReturnSalesByCondition:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/getReturnOrderList",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()},getReturnSalesByOrderId:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/getReturnOrderDetailList",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()},getReturnReasonList:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.post("/api/order/v1/order/getReturnReasonList");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},t,e)}))()},findOrderCurrency:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.post("/api/order/v1/order/findOrderCurrency");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},t,e)}))()},getReturnResponsiblePartyList:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.a.post("/api/order/v1/order/getReturnResponsiblePartyList");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},t,e)}))()},selectReturnItems:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/selectReturnItems",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()},createReturnSaleOrder:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/creatReturnSaleOrder",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()},findOrderByImei:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/findOrderByImei",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()},findOrderByOrderId:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.post("/api/order/v1/order/findOrderByOrderId",e);case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}},r,t)}))()}}},445:function(e,t,r){var a=r(446);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(154)("684afc8b",a,!0)},446:function(e,t,r){t=e.exports=r(153)(void 0),t.push([e.i,".salesReturn-box{background-color:#fff;padding-bottom:20px}.el-form-item{margin-bottom:10px}.salesReturn-title{height:40px;margin:0 10px;line-height:40px;font-size:14px;font-weight:700;border-bottom:1px solid #dbdbdb}.salesReturn-content .el-form-item__label{font-size:12px}.salesReturn-content,.salesReturn-table{border:1px solid #dbdbdb;padding:10px;margin:10px 10px 0}.salesReturn-table_title{width:100%;height:30px;line-height:30px;font-size:14px;font-weight:700}.salesReturn-operator{width:100%;margin:10px 0 0}.salesReturn-notes{margin:10px 10px 0;border:1px solid #dbdbdb;padding:10px}.salesReturn-notes_title{width:100%;height:30px;line-height:30px;font-size:14px;font-weight:700}.salesReturn-submit{margin:10px 10px 0;text-align:right}.iconList{width:20px;height:20px;display:inline-block;margin-right:5px}.gridDataTable tr,.iconList{cursor:pointer}",""])},447:function(e,t,r){var a=r(448);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(154)("456f4cae",a,!0)},448:function(e,t,r){t=e.exports=r(153)(void 0),t.push([e.i,".selectDialog{width:1050px!important}",""])},449:function(e,t,r){var a=r(450);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(154)("d3d30526",a,!0)},450:function(e,t,r){t=e.exports=r(153)(void 0),t.push([e.i,".errorMessage[data-v-1e428023]{margin-bottom:10px;color:#e50038}.gridDataTable tr[data-v-1e428023]{cursor:pointer}.imei[data-v-1e428023]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;background-image:none;border-radius:4px;border:1px solid #bfd3d9;-webkit-box-sizing:border-box;box-sizing:border-box;color:#1f363d;display:inline-block;font-size:inherit;height:36px;line-height:1;outline:none;padding:3px 10px;-webkit-transition:border-color .2s cubic-bezier(.645,.045,.355,1);transition:border-color .2s cubic-bezier(.645,.045,.355,1);width:200px}.imei[data-v-1e428023]:hover{border-color:#839ba5}.imei[data-v-1e428023]:focus{outline:none;border-color:#1fbcd2}",""])},451:function(e,t,r){var a=r(452);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(154)("2186d2a8",a,!0)},452:function(e,t,r){t=e.exports=r(153)(void 0),t.push([e.i,".editDialog{width:1100px!important}",""])},453:function(e,t,r){var a=r(454);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(154)("4a2eb2c6",a,!0)},454:function(e,t,r){t=e.exports=r(153)(void 0),t.push([e.i,".page_box[data-v-22d03580]{margin:15px 0;float:right;margin-right:-5px}.imei[data-v-22d03580]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;background-image:none;border-radius:4px;border:1px solid #bfd3d9;-webkit-box-sizing:border-box;box-sizing:border-box;color:#1f363d;display:inline-block;font-size:inherit;height:36px;line-height:1;outline:none;padding:3px 10px;-webkit-transition:border-color .2s cubic-bezier(.645,.045,.355,1);transition:border-color .2s cubic-bezier(.645,.045,.355,1);width:200px}.imei[data-v-22d03580]:hover{border-color:#839ba5}.imei[data-v-22d03580]:focus{outline:none;border-color:#1fbcd2}",""])},541:function(e,t,r){"use strict";function a(e){r(447),r(449)}function s(e){r(451),r(453)}function o(e){r(445)}Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),n=r(403),l=r(85),c=r.n(l),u={props:["itemsVisible","returnItemsId"],data:function(){return{dataItemsVisible:!0,itemsForm:{orderId:"",imei:"",searchLoading:!1},errMsg:"",itemsData:[],selectDataList:[],addLoading:!1,isClick:!0,timer:null}},created:function(){this.itemsForm.orderId=this.returnItemsId,this.scanQRCode=c()(this.searchIMEI,500),this.searchIMEI()},watch:{dataItemsVisible:function(){this.$emit("update:itemsVisible",this.dataItemsVisible)},selectDataList:function(){this.selectDataList.length>0?this.isClick=!1:this.isClick=!0}},methods:{getRealIMEIArr:function(e){var t=this.itemsForm.imei,r=[];if(!t)return r;if(-1!=t.indexOf("|")&&(t=t.replace(/[|]/g,"")),t.length>15&&t.length%15==0){if(!new RegExp("^[0-9]*$").test(t))return this.errMsg="Please enter correct IMEI code",e.focus(),!1;for(var a="",s=0,o=t.length;s<o;s++)a+=t[s],(s+1)%15==0&&(r.indexOf(a)<0&&r.push(a),a="")}else{if(!new RegExp("^([0-9]{15})$").test(t))return this.errMsg="Please enter correct IMEI code",e.focus(),!1;if(t.indexOf("012345678912456")>-1)return this.search.imei="",!1;r.push(t)}return r},delayAjaxEvt:function(e,t){clearTimeout(this.timer),this.timer=setTimeout(function(){"function"==typeof e&&e()},t)},searchIMEI:function(){var e=this,t=this.$refs.imei,r=this.getRealIMEIArr(t);if(this.itemsForm.searchLoading=!0,!r)return this.itemsForm.searchLoading=!1,!1;this.errMsg="",this.delayAjaxEvt(function(){n.a.selectReturnItems({imei:r.join(","),orderId:e.itemsForm.orderId}).then(function(t){if(e.itemsForm.searchLoading=!1,1==t.success){if(e.itemsForm.imei="",e.errMsg="",t.data&&t.data.pageInfo&&t.data.pageInfo.list&&t.data.pageInfo.list.length?e.itemsData=t.data.pageInfo.list:e.itemsData=[],t.data&&t.data.errorInfo){var r="";""!=t.data.errorInfo[0].notExistImei?(r+="IMEI not in this order:"+t.data.errorInfo[0].notExistImei,""!=t.data.errorInfo[1].hasReturnedImei&&(r+=", IMEI has return:"+t.data.errorInfo[1].hasReturnedImei)):""!=t.data.errorInfo[1].hasReturnedImei&&(r+="IMEI has return:"+t.data.errorInfo[1].hasReturnedImei),e.errMsg=e.errMsg+r}}else e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})}).catch(function(t){e.itemsForm.searchLoading=!1,e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})})},1e3)},hideDialogItemsForm:function(){this.dataItemsVisible=!1},submitDialogItemsForm:function(){this.selectDataList.length>0?(this.addLoading=!0,this.$emit("click",this.selectDataList),this.$emit("update:itemsVisible",!1)):this.$message({showClose:!0,message:"Return items no selected",type:"error"})},handleSelectionChange:function(e){this.selectDataList=e},isSelectTableEvt:function(e){return 0!=e.canReturnQuantity}}},d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"Select Items",visible:e.dataItemsVisible,"custom-class":"selectDialog","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dataItemsVisible=t}}},[r("el-form",{attrs:{inline:!0,model:e.itemsForm,onsubmit:"return false;"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"Order ID:"}},[r("label",[e._v(e._s(e.itemsForm.orderId))])])],1),e._v(" "),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"IMEI:"}},[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.itemsForm.imei,expression:"itemsForm.imei",modifiers:{trim:!0}}],ref:"imei",staticClass:"imei",staticStyle:{width:"300px"},attrs:{type:"text"},domProps:{value:e.itemsForm.imei},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.scanQRCode(t)},input:function(t){t.target.composing||e.$set(e.itemsForm,"imei",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})])],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.itemsForm.searchLoading},on:{click:e.searchIMEI}},[e._v("Search")])],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"errorMessage"},[e._v(e._s(e.errMsg))]),e._v(" "),r("el-table",{staticStyle:{"font-size":"12px"},attrs:{data:e.itemsData,"min-height":"450","max-height":"450"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.isSelectTableEvt}}),e._v(" "),r("el-table-column",{attrs:{prop:"ean",label:"EAN"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productDesc",label:"Product Description"}}),e._v(" "),r("el-table-column",{attrs:{prop:"imei",label:"IMEI"}}),e._v(" "),r("el-table-column",{attrs:{label:"Refundable/Ordered Qty"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.canReturnQuantity)+" / "+e._s(+t.row.quantity)+"\n                ")]}}])})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.hideDialogItemsForm}},[e._v("Cancel")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.addLoading,disabled:e.isClick},on:{click:e.submitDialogItemsForm}},[e._v("Add")])],1)],1)],1)},m=[],p={render:d,staticRenderFns:m},h=p,f=r(99),b=a,g=f(u,h,!1,b,"data-v-1e428023",null),v=g.exports,I={props:["dataVisible","currencyUom"],data:function(){return{dataCloseVisible:!0,storeData:[],dialogForm:{store:"",imei:"",searchLoading:!1},currencyAmount:"Amount",orderData:{pageNum:1,pageSize:10,pages:1,list:[],total:0,size:0}}},mounted:function(){var e=this;this.currencyUom&&(this.currencyAmount=this.currencyAmount+"("+this.currencyUom+")"),n.a.getStoreData().then(function(t){1==t.success?t.data&&t.data.length?(e.storeData=t.data.sort(function(e,t){return e.storeName>t.storeName?1:e.storeName<t.storeName?-1:0}),e.dialogForm.store=e.storeData[0].storeId):e.storeData=[]:e.$message({type:"error",message:"Store query failed",showClose:!0})}).catch(function(t){e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})})},watch:{dataCloseVisible:function(){this.$emit("update:dataVisible",this.dataCloseVisible)}},computed:{orderList:function(){var e=this.orderData.list;return e&&e.length&&e.forEach(function(e,t,r){e.orderDate=i.a.getServerDateStrByLocal(+e.orderDate,"dd/MM/yyyy hh:mm:ss"),e.orderItemDetailList.length>3&&(e.orderItemDetailList=e.orderItemDetailList.slice(0,3),e.orderItemDetailList.push({quantity:"-1",productDesc:"..."}))}),this.orderData}},methods:{onSubmit:function(){var e=this;if(!/^([0-9]{15})$/.test(this.dialogForm.imei)&&""!=this.dialogForm.imei)return this.$message({type:"error",message:"Please enter correct IMEI code",showClose:!0}),!1;this.dialogForm.searchLoading=!0,n.a.findOrderByImei({imei:this.dialogForm.imei,storeId:this.dialogForm.store,pageSize:this.orderData.pageSize,pageNum:this.orderData.pageNum}).then(function(t){e.dialogForm.searchLoading=!1,1==t.success?t.data&&t.data.list&&t.data.list.length?e.orderData=t.data:e.orderData=[]:e.$message({type:"error",message:t.message||"Service exceptions！",showClose:!0})}).catch(function(t){e.dialogForm.searchLoading=!1,e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})})},rowClickEvt:function(e){this.$emit("click",e),this.$emit("update:dataVisible",!1)}}},y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"Select Order in Lastest 48h",visible:e.dataCloseVisible,"custom-class":"editDialog","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dataCloseVisible=t}}},[r("el-form",{attrs:{inline:!0,model:e.dialogForm}},[r("el-form-item",{attrs:{label:"Store"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"Select Store"},model:{value:e.dialogForm.store,callback:function(t){e.$set(e.dialogForm,"store",t)},expression:"dialogForm.store"}},e._l(e.storeData,function(e){return r("el-option",{key:e.storeId,attrs:{label:e.storeName,value:e.storeId}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"IMEI"}},[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.dialogForm.imei,expression:"dialogForm.imei",modifiers:{trim:!0}}],staticClass:"imei",attrs:{type:"text",maxlength:"15"},domProps:{value:e.dialogForm.imei},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onSubmit(t)},input:function(t){t.target.composing||e.$set(e.dialogForm,"imei",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.dialogForm.searchLoading},on:{click:e.onSubmit}},[e._v("Search")])],1)],1),e._v(" "),r("el-table",{staticClass:"gridDataTable",staticStyle:{"font-size":"12px",cursor:"pointer"},attrs:{"min-height":"450","max-height":"450",data:e.orderList.list,"default-sort":{prop:"orderedDate",order:"descending"},"empty-text":"No order data."},on:{"row-dblclick":e.rowClickEvt}},[r("el-table-column",{attrs:{prop:"orderDate",sortable:"",label:"Ordered Date",width:"160"}}),e._v(" "),r("el-table-column",{attrs:{prop:"orderId",sortable:"",label:"Ordered ID",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productDesc",label:"Purchased Goods",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.orderItemDetailList,function(t){return r("div",[-1!=t.quantity?r("div",[e._v(" "+e._s(t.quantity)+" * "+e._s(t.productDesc)+" ")]):r("div",[e._v(" "+e._s(t.productDesc)+" ")])])})}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"customerName",sortable:"",label:"Customer"}}),e._v(" "),r("el-table-column",{attrs:{label:e.currencyAmount,sortable:"",prop:"total",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"storeName",sortable:"",label:"Store",width:"160"}})],1),e._v(" "),e.orderData.list&&e.orderData.list.length?r("div",{staticClass:"page_box"},[r("el-pagination",{attrs:{layout:"prev, pager, next, jumper",total:e.orderData.total,"page-size":e.orderData.pageSize,"current-page":e.orderData.pageNum},on:{"update:currentPage":function(t){e.$set(e.orderData,"pageNum",t)},"current-change":e.onSubmit}})],1):e._e()],1)],1)},x=[],F={render:y,staticRenderFns:x},w=F,_=r(99),R=s,D=_(I,w,!1,R,"data-v-22d03580",null),S=D.exports,k={data:function(){return{dialogFormVisible:!1,dialogItemsVisible:!1,searchForm:{returnNo:"",orderId:"",store:"",storeId:"",customerName:"",customerMobile:"",customerAddress:"",returnReasonId:"",responsiblePartyId:"",contactMathId:"",partyId:"",submitLoading:!1,comments:""},tableData:[],responsiblePartyData:[],returnReasonData:[],multipleSelection:[],returnTypeData:[{returnTypeId:"RE-SALE",returnTypeName:"Re-Sale"}],oldData:"",currencyUnit:"Unit",currencySubtotal:"Subtotal",currencyUom:"",returnItemsId:""}},components:{selectOrderDialog:S,returnItemsDialog:v},mounted:function(){var e=this;n.a.getReturnReasonList().then(function(t){1==t.success?t.data&&t.data.length?e.returnReasonData=t.data:e.returnReasonData=[]:e.$message({type:"error",message:"Return reason query failed",showClose:!0})}).catch(function(t){e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})}),n.a.getReturnResponsiblePartyList().then(function(t){1==t.success?t.data&&t.data.length?e.responsiblePartyData=t.data:e.responsiblePartyData=[]:e.$message({type:"error",message:"Return responsible party query failed",showClose:!0})}).catch(function(t){e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})}),n.a.findOrderCurrency().then(function(t){1==t.success?t.data&&(e.currencyUom=t.data,e.currencyUnit=e.currencyUnit+"("+t.data+")",e.currencySubtotal=e.currencySubtotal+"("+t.data+")"):e.$message({type:"error",message:"Currency query failed",showClose:!0})}).catch(function(t){e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})})},methods:{createReturnSaleOrder:function(){var e=this,t=/^[0-1]\d{9}$/;return""==this.searchForm.orderId||""==this.searchForm.customerName||""==this.searchForm.customerMobile||""==this.searchForm.returnReasonId||""==this.searchForm.returnReasonId?(this.$message({type:"warning",message:"Sales Return condition no fill",showClose:!0,duration:5e3}),!1):t.test(this.searchForm.customerMobile)?0==this.multipleSelection.length?(this.$message({type:"warning",message:"Return items no selected",showClose:!0,duration:5e3}),!1):(this.multipleSelection.forEach(function(e){e.wantReturnQuantity=Math.abs(e.num)}),this.searchForm.submitLoading=!0,void n.a.createReturnSaleOrder({returnItemList:this.multipleSelection,returnReasonId:this.searchForm.returnReasonId,storeId:this.searchForm.storeId,comments:this.searchForm.comments,contactMathId:this.searchForm.contactMathId||"",customerAddress:this.searchForm.customerAddress||"",customerMobile:this.searchForm.customerMobile,customerName:this.searchForm.customerName,orderId:this.searchForm.orderId,partyId:this.searchForm.partyId,responsiblePartyId:this.searchForm.responsiblePartyId}).then(function(t){e.searchForm.submitLoading=!1,1==t.success?e.$alert("Sales return create success","Sales return",{confirmButtonText:"Confirm",callback:function(){e.$router.push({path:"/salesReturnList",query:{orderId:e.searchForm.orderId}})}}):e.$message({type:"error",message:t.message||"Service exceptions！",showClose:!0})}).catch(function(t){e.searchForm.submitLoading=!1,e.$message({showClose:!0,message:t.message||"Service exceptions！",type:"error"})})):(this.$message({type:"warning",message:"Please enter a 10-digit phone number that starts with 0 or 1",showClose:!0,duration:5e3}),!1)},chooseOrderIdEvt:function(){this.dialogFormVisible=!0},changeOrderIdEvt:function(){var e=this;if(""==this.searchForm.orderId)return!1;this.$confirm("Do you want to modify Order ID ?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(function(){n.a.findOrderByOrderId({orderId:e.searchForm.orderId}).then(function(t){1==t.success?t.data&&t.data.length?(e.updateOrderIdEvt(t.data[0]),e.comments="",e.tableData=[]):(e.searchForm.orderId=e.oldData,e.$message({type:"error",message:"Modify error！",showClose:!0})):(e.searchForm.orderId=e.oldData,e.$message({type:"error",message:t.message||"Service exceptions！",showClose:!0}))}).catch(function(t){e.searchForm.orderId=e.oldData,e.$message({type:"error",message:t.message||"Service exceptions！",showClose:!0})})}).catch(function(){e.searchForm.orderId=e.oldData})},updateOrderIdEvt:function(e){this.oldData=e.orderId,this.searchForm.orderId=e.orderId,this.searchForm.store=e.storeName,this.searchForm.storeId=e.productStoreId,this.searchForm.customerName=e.customerName,this.searchForm.customerMobile=e.customerMobile,this.searchForm.customerAddress=e.customerAddress,this.searchForm.contactMathId=e.contactId,this.searchForm.partyId=e.buyerId,this.searchForm.comments="",this.tableData=[]},updateReturnItemsEvt:function(e){var t=this;if(0==this.tableData.length)e.forEach(function(e){t.$set(e,"num",-1),e.returnType="RE-SALE"}),this.tableData=e;else for(var r=this.tableData.map(function(e){return e.imei}),a=this.tableData.map(function(e){return e.productId}),s=0;s<e.length;s++)-1!=r.indexOf(e[s].imei)&&-1!=a.indexOf(e[s].productId)||(this.$set(e[s],"num",-1),e[s].returnType="RE-SALE",this.tableData=this.tableData.concat(e[s]))},handleSelectionChange:function(e){this.multipleSelection=e},addReturnItems:function(){if(!this.searchForm.orderId)return this.$message.error("Please fill in order id. "),!1;this.returnItemsId=this.searchForm.orderId,this.dialogItemsVisible=!0},deleteReturnItems:function(){if(0==this.multipleSelection.length)return this.$message.error("Please select return items."),!1;for(var e=this.multipleSelection.map(function(e){return e.productId}),t=0;t<this.tableData.length;t++)-1!=e.indexOf(this.tableData[t].productId)&&(this.tableData.splice(t,1),t-=1)},getSummaries:function(e){for(var t=e.data,r=0,a=0,s=0,o=0;o<t.length;o++)r+=+t[o].unit,a+=+t[o].num,s+=+t[o].unit*+t[o].num;return["Total","","","","",i.a.formatToThousands(r.toFixed(2)),a,"",i.a.formatToThousands(s.toFixed(2)),""]}},filters:{formatNumber:function(e){return i.a.formatToThousands(e)}}},C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"salesReturn-box"},[r("div",{staticClass:"salesReturn-title"},[e._v("Create Sales Return")]),e._v(" "),r("div",{staticClass:"salesReturn-content"},[r("el-form",{staticClass:"salesReturn-form",attrs:{model:e.searchForm,"label-width":"150px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Return No."}},[r("el-input",{attrs:{size:"small",placeholder:"Return No.",disabled:!0},model:{value:e.searchForm.returnNo,callback:function(t){e.$set(e.searchForm,"returnNo",t)},expression:"searchForm.returnNo"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Order ID",required:""}},[r("el-input",{attrs:{size:"small",placeholder:"Order ID"},on:{blur:e.changeOrderIdEvt},model:{value:e.searchForm.orderId,callback:function(t){e.$set(e.searchForm,"orderId",t)},expression:"searchForm.orderId"}},[r("el-button",{attrs:{slot:"append",icon:"more"},on:{click:e.chooseOrderIdEvt},slot:"append"})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Store",required:""}},[r("el-input",{attrs:{size:"small",placeholder:"Store",disabled:!0},model:{value:e.searchForm.store,callback:function(t){e.$set(e.searchForm,"store",t)},expression:"searchForm.store"}}),e._v(" "),r("el-input",{staticStyle:{display:"none"},attrs:{size:"small"},model:{value:e.searchForm.storeId,callback:function(t){e.$set(e.searchForm,"storeId",t)},expression:"searchForm.storeId"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Customer Name",required:""}},[r("el-input",{attrs:{size:"small",placeholder:"Customer Name"},model:{value:e.searchForm.customerName,callback:function(t){e.$set(e.searchForm,"customerName",t)},expression:"searchForm.customerName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Customer Mobile",required:""}},[r("el-input",{attrs:{size:"small",placeholder:"Customer Mobile"},model:{value:e.searchForm.customerMobile,callback:function(t){e.$set(e.searchForm,"customerMobile",t)},expression:"searchForm.customerMobile"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Customer Address"}},[r("el-input",{attrs:{size:"small",placeholder:"Customer Address"},model:{value:e.searchForm.customerAddress,callback:function(t){e.$set(e.searchForm,"customerAddress",t)},expression:"searchForm.customerAddress"}}),e._v(" "),r("el-input",{staticStyle:{display:"none"},attrs:{size:"small"},model:{value:e.searchForm.contactMathId,callback:function(t){e.$set(e.searchForm,"contactMathId",t)},expression:"searchForm.contactMathId"}}),e._v(" "),r("el-input",{staticStyle:{display:"none"},attrs:{size:"small"},model:{value:e.searchForm.partyId,callback:function(t){e.$set(e.searchForm,"partyId",t)},expression:"searchForm.partyId"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Return Reason",required:""}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",placeholder:"Select Return Reason"},model:{value:e.searchForm.returnReasonId,callback:function(t){e.$set(e.searchForm,"returnReasonId",t)},expression:"searchForm.returnReasonId"}},e._l(e.returnReasonData,function(e){return r("el-option",{key:e.returnReasonId,attrs:{label:e.description,value:e.returnReasonId}})}))],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"Responsible Party",required:""}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"Select Responsible Party"},model:{value:e.searchForm.responsiblePartyId,callback:function(t){e.$set(e.searchForm,"responsiblePartyId",t)},expression:"searchForm.responsiblePartyId"}},e._l(e.responsiblePartyData,function(e){return r("el-option",{key:e.returnResponsiblePartyId,attrs:{label:e.responsiblePartyDesc,value:e.returnResponsiblePartyId}})}))],1)],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"salesReturn-table"},[r("div",{staticClass:"salesReturn-table_title"},[e._v("Return Items")]),e._v(" "),r("el-table",{staticStyle:{width:"100%","font-size":"12px"},attrs:{data:e.tableData,"summary-method":e.getSummaries,"show-summary":"",border:"","tooltip-effect":"dark","empty-text":"No return items data."},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"70"}}),e._v(" "),r("el-table-column",{attrs:{label:"Product ID",prop:"productId"}}),e._v(" "),r("el-table-column",{attrs:{label:"EAN",prop:"ean"}}),e._v(" "),r("el-table-column",{attrs:{label:"Product Desc",prop:"productDesc"}}),e._v(" "),r("el-table-column",{attrs:{label:"IMEI",prop:"imei"}}),e._v(" "),r("el-table-column",{attrs:{label:e.currencyUnit},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e._f("formatNumber")(t.row.unit))+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"Quantity",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.imei?r("label",[e._v(e._s(t.row.num))]):r("el-input-number",{attrs:{size:"small",max:-1,min:-t.row.canReturnQuantity,step:1},model:{value:t.row.num,callback:function(r){e.$set(t.row,"num",r)},expression:"scope.row.num"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"Available / Ordered Qty"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.canReturnQuantity)+" / "+e._s(+t.row.quantity)+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:e.currencySubtotal,width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e._f("formatNumber")((t.row.num*t.row.unit).toFixed(2)))+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"Return Type",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{model:{value:t.row.returnType,callback:function(r){e.$set(t.row,"returnType","string"==typeof r?r.trim():r)},expression:"scope.row.returnType"}},e._l(e.returnTypeData,function(e){return r("el-option",{key:e.returnTypeId,attrs:{label:e.returnTypeName,value:e.returnTypeId}})}))]}}])})],1),e._v(" "),r("div",{staticClass:"salesReturn-operator"},[r("i",{staticClass:"el-icon-plus iconList",on:{click:e.addReturnItems}}),e._v(" "),r("i",{staticClass:"el-icon-minus iconList",on:{click:e.deleteReturnItems}})])],1),e._v(" "),r("div",{staticClass:"salesReturn-notes"},[r("div",{staticClass:"salesReturn-notes_title"},[e._v("Notes")]),e._v(" "),r("el-input",{attrs:{type:"textarea",rows:4,placeholder:"Please enter"},model:{value:e.searchForm.comments,callback:function(t){e.$set(e.searchForm,"comments",t)},expression:"searchForm.comments"}})],1),e._v(" "),r("div",{staticClass:"salesReturn-submit"},[r("el-button",{attrs:{type:"primary",loading:e.searchForm.submitLoading},on:{click:e.createReturnSaleOrder}},[e._v("Submit")])],1),e._v(" "),e.dialogFormVisible?r("select-order-dialog",{attrs:{currencyUom:e.currencyUom,dataVisible:e.dialogFormVisible},on:{"update:dataVisible":function(t){e.dialogFormVisible=t},click:e.updateOrderIdEvt}}):e._e(),e._v(" "),e.dialogItemsVisible?r("return-items-dialog",{attrs:{returnItemsId:e.returnItemsId,itemsVisible:e.dialogItemsVisible},on:{"update:itemsVisible":function(t){e.dialogItemsVisible=t},click:e.updateReturnItemsEvt}}):e._e()],1)},$=[],L={render:C,staticRenderFns:$},M=L,E=r(99),O=o,N=E(k,M,!1,O,null,null);t.default=N.exports}});